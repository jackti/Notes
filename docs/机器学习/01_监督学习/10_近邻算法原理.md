# 近邻算法原理

$k$近邻法(k-nearest neighbor ,k-NN)是一种基本的分类与回归方法。$k$近邻法不具有显示的学习过程，它利用训练数据集对特征向量空间进行划分，并作为其分类的"模型"。$k$值的选择、距离度量以及分类决策规则是$k$近邻法的三要素。

## $k$值的选择

选择较小的$k$值，相当于用较小领域的训练实例进行预测，训练误差会减小，只有与输入实例较近或相似的训练实例才会对预测结果起作用，这样就会导致泛化误差会增大。$k$值的减小意味着整体模型变得复杂，容易发生过拟合。

选择较大的$k$值，相当于用较大领域中的训练实例进行预测，优点是可以减少泛化误差，但缺点是训练误差会增大。这时候，与输入实例较远的训练实例也会对预测器作用，导致预测发生错误，且$k$值增大意味着整体的模型变得简单。

在应用中，$k$值一般取一个比较小的数值。通常采用交叉验证来选取最优的$k$值。

## 距离度量

特征空间中两个实例点的距离是两个实例点相似程度的反映。对于两个$n$维向量$x,y\in \mathbb{R}^n$常用的闵可夫斯基距离(Minkowski Distance)公式如下：

$$
L_p(x,y)=(\sum_{i=1}^n|x_i-y_i|^p)^{1/p}
$$

当$p=1$时候，称为曼哈顿距离(Manhanttan Distance)，即

$$
L_1(x,y)=\sum_{i=1}^n|x_i-y_i|
$$

当$p=2$时候，称为欧氏距离(Euclidean Distance)，即

$$
L_2(x,y)=(\sum_{i=1}^n|x_i-y_i|^2)^{1/2}
$$

当$p=\infty$时候，它是各个坐标距离的最大值，即

$$
L_{\infty}(x,y)=\max_i|x_i-y_i|
$$

## 分类决策规则

$k$近邻法中的分类决策规则往往是多数表决，即由输入实例的$k$个近邻的训练实例中多数类决定输入实例的类。==多数表决等价于经验风险最小化==。



## KNN算法扩展

(1)$k$近邻算法实现时主要考虑的问题是如果对训练数据进行快速$k$近邻搜索。最简单的实现方式是线性扫描，这时要计算输入实例和每一个训练实例的距离。当训练集很大的时，计算非常耗时。为了提高$k$近邻搜索的效率，需要考虑使用特殊的结构存储训练数据，以减少计算距离的次数，就出现了一些优化实现，如$KD$树和球树。

(2)如果出现样本不均衡的情况，即样本中某类别的样本非常少，甚至小于$k$，会导致稀有类别样本在找$k$个最近邻的时候，会把距离其实比较远的其他样本考虑进来，进而导致预测不准确。为了解决这个问题，可以限定最近邻的一个最大距离，即只有在这个最大距离范围内搜索所有的最近邻。

(3)最近质心算法首先把样本按输出类别归类。对于第$i$类的$n_i$个样本，对这$n_i$个样本的特征中每一维度特征求平均值，最终该类别所有维度的平均值形成所谓的质心，对于样本中所有出现的类别，每个类别都会有一个质心点。在预测的时候，仅仅只需要比较预测样本和这些质心的距离，最小的距离所对应的质心类别即为预测的类别。



































