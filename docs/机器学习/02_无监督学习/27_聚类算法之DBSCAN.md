# 聚类算法之DBSCAN

密度聚类亦称为"基于密度的聚类"，此类算法假设聚类结构能通过样本分布的紧密程度确定。通常情形下，密度聚类算法从样本密度的角度来考察样本之间的可连接性，并基于可连接样本不断扩展聚类簇以获得最终的聚类结果。

DBSCAN是一种典型的基于密度聚类算法，和K-Means、BIRCH这些一般只适用于凸样本集的聚类相比，DBSCAN既可以适用于凸样本集，也可以适用于非凸样本集。



## 基本定义

DBSCAN是基于一组领域来描述样本集的机密程度，参数$(\epsilon,MinPts)$用来描述邻域的样本分布紧密程度。其中，$\epsilon$描述了某一样本的邻域距离阈值，$MinPts$描述了某一样本的距离为$\epsilon$的邻域中样本个数的阈值。

假设样本数据集$D=\{ x^{(1)} , x^{(2)},..., x^{(m)}\}$，则DBSCAN具体的密度描述定义如下：

（1）$\epsilon-$邻域：对于$x^{(j)}\in D$，其$\epsilon-$邻域包含样本集$D$中与$x^{(j)}$的距离不大于$\epsilon$的子样本集，即$N_{\epsilon}(x^{(j)})={x^{(i)}\in D| distance(x^{(i)},x^{(j)})\le \epsilon }$，这样子样本集的个数记为$|N_{\epsilon}(x^{(j)})|$。

（2）核心对象：对于任一样本$x^{(j)}\in D$，如果其$\epsilon-$邻域对应的$N_{\epsilon}(x^{(j)})$至少包含$MinPts$个样本，即如果$|N_{\epsilon(x^{(j)})}|\ge MinPts$，则$x^{(j)}$是核心对象。

（3）密度直达：如果$x^{(i)}$位于$x^{(j)}$的$\epsilon-$邻域中，且$x^{(j)}$是核心对象，则称$x^{(i)}$由$x^{(j)}$密度直达。**注意反之不一定成立，因为此时$x^{(i)}$不一定是核心对象**。

（4）密度可达：对于$x^{(i)}$和$x^{(j)}$，如果存在样本序列$p_1,p_2,...,p_T$，满足$p_1=x^{(i)},p_T=x^{(j)}$，且$p_{t+1}$由$p_t$密度直达，则称$x^{(j)}$由$x^{(i)}$密度可达。此时序列中的传递样本$p_1,p_2,...,p_{T-1}$均为核心对象。**注意密度可达也不满足对称性。**

（5）密度相连：对于$x^{(i)}$和$x^{(j)}$，如果存在核心对象样本$x^{(k)}$，使$x^{(i)}$和$x^{(j)}$均由$x^{(k)}$密度可达，则称$x^{(i)}$和$x^{(j)}$密度相连。**注意密度相连关系是满足对称性的。**





## DBSCAN聚类算法

DBSCAN的聚类思想很简单：由密度可达关系导出的最大密度相连样本集合，即最终聚类的一个类别或簇。

在DBSCAN的簇里面可以有一个或者多个核心对象。如果只有一个核心对象，则簇里其他的非核心样本都在这个核心对象的$\epsilon-$邻域里；如果有多个核心对象，则簇里的任意一个核心对象的$\epsilon-$邻域一定有一个其他的核心对象，否则这两个核心对象无法密度可达。这些核心对象的$\epsilon-$邻域里所有的样本集合组成一个DBSCAN聚类簇。

一些异常点或者说少量游离在簇外的样本点，这些点不在任何一个核心对象的周围，在DBSCAN中，一般将这些样本点标记为噪音点。

DBSCAN的算法流程：

> 输入：样本集$D=\{x^{(1)},x^{(2)},...,x^{(m)} \}$，邻域参数$(\epsilon,MinPts)$
>
> 输出：簇划分$C$
>
> (1)初始化核心对象集合$\Omega=\empty$，聚类簇数$k=0$，未访问样本集合$\Gamma=D$，簇划分$C=\empty$
>
> (2)对于$j=1,2,...,m$按如下步骤找出所有的核心对象：
>
> ​	①通过距离计算，找到样本$x^{(j)}$的$\epsilon-$邻域子样本集$N_{\epsilon}(x^{(j)})$；
>
> ​	②如果子样本集样本个数满足$|N_{\epsilon}(x^{(j)})|\ge MinPts$，将样本$x^{(j)}$加入核心对象样本集合$\Omega=\Omega \cup{x^{(j)}}$
>
> (3)如果核心对象集合$\Omega=\empty$，则算法结束，否则转入步骤(4)
>
> (4)在核心对象集合$\Omega$中，随机选择一个核心对象$o$，初始化当前簇核心对象队列$\Omega_{cur}=\{o\}$，初始化类别序号$k=k+1$，初始化当前簇样本集合$C_k=\{o\}$，更新未访问样本集合$\Gamma=\Gamma-\{o\}$
>
> (5)如果当前簇核心对象队列$\Omega_{cur}=\empty$，则当前聚类簇$C_k$生成完毕，更新簇划分$C=\{C_1,C_2,...,C_k\}$，更新核心对象集合$\Omega=\Omega-C_k$，转入步骤(3)
>
> (6)在当前簇核心队列$\Omega_{cur}$中取出一个核心对象$o^{'}$ ，通过邻域距离阈值$\epsilon$找出所有的$\epsilon-$邻域子样本集$N_{\epsilon}(o^{'})$，令$\Delta=N_{\epsilon}(o^{'})\cap \Gamma$，更新当前簇样本集合$C_k=C_k\cup \Delta$，更新未访问样本集合$\Gamma=\Gamma-\Delta$，更新$\Omega_{cur}=\Omega{cur}\cup (N_{\epsilon}(o^{'})\cap\Omega)$，转入步骤(5)





## DBSCAN总结

DBSCAN的主要优点有：

（1）可以对任意形状的稠密数据集进行聚类，相对的，K-Means之类的聚类算法一般只适用于凸数据集。

（2）可以在聚类的同时发现异常点，对数据集中的异常点不敏感。

（3）聚类结果没有偏倚，相对的，K-Means之类的聚类算法初始值对聚类结果有很大影响。

DBSCAN的主要缺点有：

（1）如果样本集的密度不均匀、聚类间距差相差很大时，聚类质量较差，这时用DBSCAN聚类一般不适合。

（2）如果样本集较大时，聚类收敛时间较长，可以对搜索最近邻时建立的KD树或者球树进行规模限制来改进。

（3）调参相对于传统的K-Means之类的聚类算法稍复杂，主要需要对距离阈值$\epsilon$，邻域样本数阈值$MinPts$联合调参，不同的参数组合对最后的聚类效果有较大影响。

 































